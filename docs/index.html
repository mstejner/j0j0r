<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculate the j0j0 terms in the fluctuation model of Bindslev 1996 • j0j0r</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Calculate the j0j0 terms in the fluctuation model of Bindslev 1996">
<meta property="og:description" content="Package to calculate terms in the  unscreened current fluctuation 
    correlation tensor in the fluctuation model of Bindslev 1996, Journal of 
    Atmospheric and Terrestial Physics, 58, 983. Can in princple handle 
    arbitrary velocity distributions, and users are free to define new 
    distributions. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">j0j0r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/j0j0r_intro.html">j0j0r: An R-package for numerical calculations of current correlation tensors</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mstejner/j0j0r/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="j0j0r" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#j0j0r" class="anchor"></a>j0j0r</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p><code>j0j0r</code> is is an R-package built to calculate the unscreened current correlation tensor of the plasma fluctuation model of <a href="https://www.sciencedirect.com/science/article/pii/0021916995001298">Bindslev 1996, Journal of Atmospheric and Terrestial Physics, <strong>58</strong>, 983</a>.</p>
<p>The code is meant to be distribution-agnostic, i.e. it should be able to handle any reasonable form of the momentum distribution. Integrals over the momentum distribution are calculated numerically. Analytic solutions, possible only in special cases, are not used/supported.</p>
<p>The package contains functions to set up a number of momentum distribution types:</p>
<ul>
<li><p>An isotropic Maxwellian distribution.</p></li>
<li><p>A bi-Maxwellian distribution with drift along the magnetic field.</p></li>
<li><p>A <a href="https://www.spenvis.oma.be/help/background/distributions/distributions.html">generalized Lorentzian / Kappa</a> distribution.</p></li>
<li><p>A ring-distribution.</p></li>
<li><p>A bivariate normal distribution.</p></li>
<li><p>A slowdown distribution: an isotropic fast-ion slowdown with transport modifications as formulated by Wilkie 2018. See <a href="https://arxiv.org/abs/1808.01934v2" class="uri">https://arxiv.org/abs/1808.01934v2</a>.</p></li>
</ul>
<p>Apart from those, users are free to input new distribution functions of their own design.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="st">"devtools"</span>)) {
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)
}

<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"mstejner/j0j0r"</span>)</pre></div>
<p>The package is not yet on CRAN.</p>
</div>
<div id="vignette" class="section level2">
<h2 class="hasAnchor">
<a href="#vignette" class="anchor"></a>Vignette</h2>
<p>The example below shows the basic work flow for a Maxwellian distribution. The package vignette gives a more thorough introduction and a discussion of the effects of strongly non-Maxwellian distributions. It can be viewed with:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/build_vignettes.html">build_vignettes</a></span>()
<span class="fu"><a href="https://rdrr.io/r/utils/vignette.html">vignette</a></span>(<span class="st">"j0j0r_intro"</span>)</pre></div>
<p>And on <a href="https://mstejner.github.io/j0j0r/" class="uri">https://mstejner.github.io/j0j0r/</a> under articles.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>To run the example below, first attach the <code>j0j0r</code> and <code>magrittr</code> packages:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">j0j0r</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)</pre></div>
<p>The code is parallelized using the <a href="https://cran.r-project.org/web/packages/future/">future</a> and <a href="https://cran.r-project.org/web/packages/furrr/index.html">furrr</a> packages. To make use of the parallelization, first set a plan for the <code>future</code> package. Different plans will be appropriate for different operating systems. On Windows it could be:</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="kw pkg">future</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/future/man/plan.html">plan</a></span>(<span class="kw">strategy</span> <span class="kw">=</span> <span class="st">"multisession"</span>)</pre></div>
<p>A Maxwellian distribution can be set up with:</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">maxwellian_deuterium</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/maxwellian_setup.html">maxwellian_setup</a></span>(
  <span class="kw">n</span> <span class="kw">=</span> <span class="fl">4e19</span>,
  <span class="kw">T_eV</span> <span class="kw">=</span> <span class="fl">2000</span>,
  <span class="kw">A</span> <span class="kw">=</span> <span class="fl">2</span>,
  <span class="kw">Z</span> <span class="kw">=</span> <span class="fl">1</span>,
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"maxwellian"</span>
)</pre></div>
<p>It can be evaluated and plotted with:</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="fu"><a href="reference/calculate_distribution_data_frame.html">calculate_distribution_data_frame</a></span>(
  <span class="kw">particles</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">maxwellian_deuterium</span> <span class="kw">=</span> <span class="no">maxwellian_deuterium</span>),
  <span class="kw">v_par</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">1e6</span>, <span class="fl">1e6</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">300</span>),
  <span class="kw">v_perp</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">1e6</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">300</span>)
) <span class="kw">%&gt;%</span>
<span class="fu"><a href="reference/plot_dist.html">plot_dist</a></span>() +
<span class="kw pkg">ggplot2</span><span class="kw ns">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(
  <span class="kw">text</span> <span class="kw">=</span> <span class="kw pkg">ggplot2</span><span class="kw ns">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">11</span>),
  <span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="kw pkg">ggplot2</span><span class="kw ns">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">angle</span> <span class="kw">=</span> -<span class="fl">45</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>)
)</pre></div>
<p><img src="reference/figures/README-maxwdist-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The elements of the current correlation tensor can now be calculated with the <code>j0j0</code> function. Here assuming a magnetic field of 2.5 T, a wave vector length corresponding to 3 mm waves, resolved angles of 60, 80 and 86 degrees, and frequencies between 0 and 400 MHz.</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="no">maxwellian_example</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/j0j0.html">j0j0</a></span>(
  <span class="kw">k</span> <span class="kw">=</span> <span class="fl">2</span> * <span class="no">pi</span> / (<span class="kw pkg">j0j0r</span><span class="kw ns">::</span><span class="no"><a href="reference/const.html">const</a></span>$<span class="no">c</span> / <span class="fl">100e9</span>),
  <span class="kw">phi</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">86</span>),
  <span class="kw">frequencies</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">400e6</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">2e6</span>),
  <span class="kw">directions</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span>),
  <span class="kw">B</span> <span class="kw">=</span> <span class="fl">2.5</span>,
  <span class="kw">particles</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">maxwellian</span> <span class="kw">=</span> <span class="no">maxwellian_deuterium</span>),
  <span class="kw">integration_method</span> <span class="kw">=</span> <span class="st">"hcubature"</span>
)</pre></div>
<p>The output is a tibble with results (j0j0) for all combinations of all values of the input variables:</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(<span class="no">maxwellian_example</span>)
<span class="co">#&gt; Observations: 3,618</span>
<span class="co">#&gt; Variables: 10</span>
<span class="co">#&gt; $ k                  &lt;dbl&gt; 2095.845, 2095.845, 2095.845, 2095.845, 209...</span>
<span class="co">#&gt; $ phi                &lt;dbl&gt; 60, 80, 86, 60, 80, 86, 60, 80, 86, 60, 80,...</span>
<span class="co">#&gt; $ frequency          &lt;dbl&gt; 0.0e+00, 0.0e+00, 0.0e+00, 2.0e+06, 2.0e+06...</span>
<span class="co">#&gt; $ B                  &lt;dbl&gt; 2.5, 2.5, 2.5, 2.5, 2.5, 2.5, 2.5, 2.5, 2.5...</span>
<span class="co">#&gt; $ particle           &lt;chr&gt; "maxwellian", "maxwellian", "maxwellian", "...</span>
<span class="co">#&gt; $ integration_method &lt;chr&gt; "hcubature", "hcubature", "hcubature", "hcu...</span>
<span class="co">#&gt; $ directions         &lt;chr&gt; "xx", "xx", "xx", "xx", "xx", "xx", "xx", "...</span>
<span class="co">#&gt; $ A                  &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2...</span>
<span class="co">#&gt; $ Z                  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...</span>
<span class="co">#&gt; $ j0j0               &lt;cpl&gt; 5.984923e-16+0i, 7.253801e-17+0i, 5.095825e...</span></pre></div>
<p>The results can be plotted with:</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="fu"><a href="reference/plot_j0j0.html">plot_j0j0</a></span>(<span class="no">maxwellian_example</span>, <span class="kw">wrap_by</span> <span class="kw">=</span> <span class="st">"element"</span>, <span class="kw">color_by</span> <span class="kw">=</span> <span class="st">"phi"</span>)</pre></div>
<p><img src="reference/figures/README-maxwj0j0-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/mstejner/j0j0r/">https://​github.com/​mstejner/​j0j0r/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/mstejner/j0j0r/issues">https://​github.com/​mstejner/​j0j0r/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Morten Stejner <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Morten Stejner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
